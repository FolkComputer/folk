if {$::tcl_platform(os) ne "Linux"} { return }

Start process "watchdog" {
    # For now: every 2 seconds, check amount of free RAM
    # system-wide. If it dips below 100MB, restart Folk.
    while true {
        set freeRam [exec free -m | grep Mem | awk {{print $7}}]
        if {$freeRam < 100} {
            puts "watchdog: Free RAM is below 100MB. Restarting Folk."
            exec sudo systemctl restart folk
        }
        exec sleep 2
    }
}
